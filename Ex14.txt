Questões-tipo Exame:

Ex 14 -

a)
X0final = X0inicial*3+1

b)
No contexto do programa, as linhas 10-11 servem para verificar
se o número é par ou não

c)
É executada 5 vezes

d)
"Resultado: 6"




#include <stdio.h>
extern unsigned long collatz (unsigned long n);
int main (void)
{
	printf ("Resultado: %ld\n", collatz(10));
	return 0;
}

Ficheiro collatz.s

 1 		.text
 2 		.global collatz
 3 		.type collatz, %function
 4
 5 		collatz:
 6 				mov x1, 0					// X1 = 0
 7 		L1 :	cmp X0, 1					// X0 ~ 1
 8 				beq L3						// se X0 = 1 -> L3
 9 				add X1, X1, 1				// X1 = X1 + 1
 10 			ands X2, X0, 1				// X2 = X0 & 1
 11 			beq L2						// se X2 = 0 -> L2
 12 			mov X4, X0					// X4 = X0____________
 13 			add X0, X0, x0				// X0 = X0 + X0_______|
 14 			add X0, X0, X4				// X0 = X0 + X4_______|- X0 = 3*X0 + 1
 15 			add X0, X0, 1				// X0 = X0 + 1________|
 16 			b L1						// -> L1
 17 	L2 : 	lsr X0, X0, 1				// XO = XO -> 1
 18 			b L1						// -> L1
 19 	L3 : 	mov X0, X1					// X0 = X1
 20 			ret
 
 
  O que a rotina faz para collatz(10):
  
  X1 = 0
  X0 = 10 != 0
  X1 = 0 + 1 = 1
  X2 = 10 & 1 -> 1010 & 0001 = 0000 = 0
  -> L2_______________________________________
  X0 = 1010 -> 0101 = 5
  -> L1***************************************
  X0 = 5 != 1
  X1 = 1+1 = 2
  X2 = 5 & 1 -> 0101 & 0001 = 0001 = 1
  X2 != 0
  X0 = 3*5 + 1 = 16
  -> L1***************************************
  X0 = 16 != 1
  X1 = 2+1 = 3
  X2 = 16 & 1 = 10000 & 00001 = 00000 = 0
  -> L2_______________________________________
  X0 = 10000 -> 1000 = 8
  -> L1***************************************
  X0 = 8 != 1
  X1 = 3+1 = 4
  X2 = 8 & 1 = 1000 & 0001 = 0000 = 0
  -> L2_______________________________________
  X0 = 1000 -> 0100 = 4
  -> L1***************************************
  X0 = 4 != 1
  X1 = 4+1 = 5
  X2 = 4 & 1 = 0100 & 0001 = 0000 = 0
  -> L2_______________________________________
  X0 = 0100 -> 0010 = 2
  -> L1***************************************
  X0 = 2 != 1
  X1 = 5+1 = 6
  X2 = 2 & 1 = 0010 & 0001 = 0000 = 0
  -> L2_______________________________________
  X0 = 0010 -> 0001 = 1
  -> L1***************************************
  X0 = 1
  -> L3+++++++++++++++++++++++++++++++++++++++
  X0 = 6
  RET